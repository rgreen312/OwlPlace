{"version":3,"sources":["message.ts","components/ScrollToTop.tsx","colorPicker/components/colorPicker.tsx","canvas/components/Canvas.tsx","canvas/constants.ts","websocket/selectors.ts","canvas/selectors.ts","login/selectors.ts","websocket/actionTypes.ts","websocket/actions.ts","canvas/actions.ts","canvas/actionTypes.ts","canvas/containers/CanvasContainer.tsx","canvas/containers/CanvasPageContainer.tsx","about/components/About.tsx","testing/components/Testing.tsx","testing/containers/TestingContainer.tsx","header/components/Header.tsx","login/actionTypes.ts","login/actions.ts","header/containers/HeaderContainer.tsx","footer/components/Footer.tsx","error/components/Error.tsx","RoutingContainer.tsx","App.tsx","constants.ts","createReducer.ts","canvas/reducers.ts","login/reducers.ts","websocket/reducers.ts","index.tsx"],"names":["MsgType","withRouter","children","pathname","location","useEffect","window","scrollTo","ColorPicker","onColorChange","onComplete","onCancel","className","style","useState","r","g","b","color","setColor","onChange","c","onColorSelection","rgb","onClick","Canvas","props","canvasRef","createRef","state","showColorPicker","previousColor","isDrag","translateX","translateY","dragStartX","dragStartY","colorPickerX","colorPickerY","bind","updateTranslate","this","current","width","height","context","getContext","registerContext","imageSmoothingEnabled","fillStyle","fillRect","addEventListener","ev","getMousePos","x","y","updatePosition","onMouseOut","e","zoomFactor","startPositionX","clientX","startPositionY","clientY","pickerX","pickerY","innerWidth","innerHeight","setState","removeEventListener","canUpdatePixel","isLoggedIn","position","imageData","getImageData","data","notification","error","message","description","prevProps","initialImage","console","log","image","Image","onload","drawImage","src","canvas","evt","rect","getBoundingClientRect","left","top","hideColorPicker","onUpdatePixel","receivedError","setZoomFactor","isLoading","size","classNames","transform","ref","type","Component","getWebSocket","websocket","socket","undefined","getIsLoadingState","getCanvasContext","canvasContext","getCurrentPosition","curPosition","getZoomFactor","getInitialImage","getTimeToChange","timeToNextChange","getIsLoggedIn","login","getUserName","name","StartConnect","ConnectSuccess","ConnectError","CloseConnection","connectError","ActionTypes","payload","closeConnection","makeUpdateMessage","id","JSON","stringify","userId","dispatch","getState","ctx","makeLoginMessage","email","setImage","setTimeRemaining","time","mapDispatchToProps","zoom","Math","ceil","newFactor","scale","newColor","updatePixelStart","send","connect","CanvasPageContainer","CanvasContainer","About","href","Testing","sendUpdateMessage","sendLoginMessage","Header","onLogin","onLogout","onGoogleScriptLoad","loginButton","key","useLocation","menu","Item","substring","length","to","hostname","dropdownMenu","overlay","border","padding","fontSize","verticalAlign","setTime","interval","clearInterval","success","setInterval","timerComponent","floor","slice","title","subTitle","extra","LoginStart","LoginSuccess","LoginError","SignOut","loginStart","loginSuccess","a","googleAPILoaded","Promise","resolve","gapi","load","auth2","init","client_id","getAuthInstance","signIn","googleUser","currentUser","get","profile","getBasicProfile","getName","getId","getEmail","signOut","Footer","Error","shouldRedirect","forceUpdate","RoutingContainer","basename","exact","path","component","AboutPage","ErrorPage","TestingPage","App","checkLogin","openConnection","React","timeout","setTimeout","race","then","isSignedIn","WebSocket","onopen","connectSuccess","onclose","event","onerror","onmessage","json","parse","IMAGE","imageString","formatString","TESTING","msg","CHANGECLIENTPIXEL","DRAWRESPONSE","status","prevMove","lastMove","VERIFICATIONFAIL","USERLOGINRESPONSE","cooldown","createReducer","initialState","handlers","action","handler","WebSocketActionTypes","combineReducers","isConnected","rootReducer","canvasReducers","loginReducers","webSocketReducers","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunk","render","document","getElementById"],"mappings":"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","file":"static/js/main.3450d7c9.chunk.js","sourcesContent":["export enum MsgType {\n    ERROR = -1,\n    OPEN = 0,\n    DRAWPIXEL = 1,\n    LOGINUSER = 2,\n    CHANGECLIENTPIXEL = 3,\n    IMAGE = 4,\n    TESTING = 5,\n    DRAWRESPONSE = 6,\n    CLOSE = 9,\n    VERIFICATIONFAIL = 10,\n    USERLOGINRESPONSE = 11\n}\n\nexport interface Msg {\n    type: number;\n}\n\nexport class ErrorMsg implements Msg {\n    type: number = MsgType.ERROR;\n}\n\nexport class ImageMsg implements Msg {\n    type: number = MsgType.IMAGE;\n    formatString: string;\n    \n    constructor(formatString: string) {\n        this.formatString = formatString;\n    }\n}\n\nexport class ChangeClientPixelMsg implements Msg {\n    type: number = MsgType.CHANGECLIENTPIXEL;\n    r: number;\n    g: number;\n    b: number;\n    x: number;\n    y: number;\n\n    constructor(r: number, g: number, b: number, x: number, y: number) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n        this.x = x;\n        this.y = y;\n\n    }\n}\n    \nexport class VerificationFailMsg implements Msg {\n    type: number = MsgType.VERIFICATIONFAIL;\n    status: number;\n    \n    constructor(status: number) {\n        this.status = status;\n    }\n}\n\nexport class UserLoginResponseMsg implements Msg {\n    type: number = MsgType.USERLOGINRESPONSE;\n    status: number;\n    cooldown: number;\n    \n    constructor(status: number, cooldown: number) {\n        this.status = status;\n        this.cooldown = cooldown;\n    }\n}\n","import { FC, useEffect } from 'react';\nimport { withRouter, RouteComponentProps } from 'react-router-dom';\n\n// @ts-ignore - TODO: figure out why typescript doesn't like this\nconst ScrollToTop: FC<RouteComponentProps> = ({\n  children,\n  location: { pathname }\n}) => {\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [pathname]);\n\n  return children || null;\n};\n\nexport default withRouter(ScrollToTop);\n","import React, { FC, useState, CSSProperties } from \"react\";\r\nimport { SketchPicker } from \"react-color\";\r\nimport { Button } from \"antd\";\r\nimport './colorPicker.scss';\r\nimport { Color } from \"../../canvas/types\";\r\n\r\ninterface RGBColor {\r\n  r: number;\r\n  g: number;\r\n  b: number;\r\n}\r\n\r\ninterface Props {\r\n  onColorChange: (color:RGBColor) => void; \r\n  onComplete: (c: Color) => void;\r\n  onCancel: () => void;\r\n  className?: string;\r\n  style?: CSSProperties;\r\n}\r\n// http://casesandberg.github.io/react-color/\r\n\r\nconst ColorPicker: FC<Props> = ({ onColorChange, onComplete, onCancel, className, style }) => {\r\n  const [color, setColor] = useState({ r: 0, g: 0, b: 0 });\r\n  const complete = () => onComplete(color);\r\n\r\n  const onColorSelection = (c) => {\r\n    setColor(c);\r\n    onColorChange(c); \r\n  }\r\n\r\n  return ( \r\n    <div className={className} style={style}>\r\n      <SketchPicker \r\n        color={color}\r\n        onChange={(c) => onColorSelection({ r: c.rgb.r, b: c.rgb.b, g: c.rgb.g })}\r\n      />\r\n      <div className='button-bar'>\r\n        <Button onClick={complete} className='okay-button'>\r\n          Okay\r\n        </Button>\r\n        <Button onClick={onCancel} className='cancel-button'>\r\n          Cancel\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\n\r\nexport default ColorPicker;\r\n","import React, { Component, createRef, RefObject } from 'react';\nimport ColorPicker from '../../colorPicker/components/colorPicker';\nimport { Redirect } from 'react-router-dom';\nimport './Canvas.scss';\nimport { Icon, Spin, notification } from 'antd';\nimport { ZOOM_CHANGE_FACTOR } from '../constants';\nimport { Color, RGBColor } from 'react-color';\nimport classNames from 'classnames';\n\ninterface Props {\n  receivedError: boolean;\n  isLoading: boolean;\n  registerContext: (context: CanvasRenderingContext2D) => void;\n  updatePosition: (x: number, y: number) => void;\n  position: { x: number; y: number };\n  onMouseOut: () => void;\n  onUpdatePixel: (newColor: Color, x: number, y: number) => void;\n  zoomFactor: number;\n  setZoomFactor: (newZoom: number) => void;\n  initialImage?: string;\n  canUpdatePixel: boolean;\n  isLoggedIn: boolean;\n}\n\ninterface State {\n  showColorPicker: boolean;\n  previousColor: RGBColor | null;\n  isDrag: boolean;\n  translateX: number;\n  translateY: number;\n  dragStartX: number;\n  dragStartY: number;\n  colorPickerX: number;\n  colorPickerY: number;\n}\n\nclass Canvas extends Component<Props, State> {\n  canvasRef: RefObject<HTMLCanvasElement>;\n\n  constructor(props) {\n    super(props);\n    this.canvasRef = createRef();\n    this.state = {\n      showColorPicker: false,\n      previousColor: null,\n      isDrag: false,\n      translateX: 0,\n      translateY: 0,\n      dragStartX: 0,\n      dragStartY: 0,\n      colorPickerX: 0,\n      colorPickerY: 0,\n    };\n    this.onCancel = this.onCancel.bind(this);\n    this.onComplete = this.onComplete.bind(this);\n    this.onColorChange = this.onColorChange.bind(this);\n    this.updateTranslate = this.updateTranslate.bind(this);\n  }\n\n  componentDidMount() {\n    this.canvasRef.current!.width = 1000;\n    this.canvasRef.current!.height = 1000;\n\n    const context = this.canvasRef.current!.getContext('2d');\n\n    if (context) {\n      this.props.registerContext(context);\n    }\n\n    context!.imageSmoothingEnabled = false;\n\n    // TODO: remove this code\n    context!.fillStyle = '#000000';\n    context!.fillRect(0, 0, 1000, 500);\n    context!.fillStyle = '#ff0000';\n    context!.fillRect(0, 500, 1000, 500);\n\n    this.canvasRef.current!.addEventListener('mousemove', ev => {\n      if (this.state.showColorPicker) return;\n      const { x, y } = this.getMousePos(this.canvasRef.current, ev);\n      this.props.updatePosition(x, y);\n    });\n\n    this.canvasRef.current!.addEventListener('mouseout', () => {\n      if (this.state.showColorPicker) return;\n      this.props.onMouseOut();\n    });\n\n    // On mousedown, get the current location to be used for dragging\n    this.canvasRef.current!.addEventListener('mousedown', e => {\n      const { zoomFactor } = this.props;\n      const { translateX, translateY } = this.state;\n      const startPositionX = e.clientX - translateX;\n      const startPositionY = e.clientY - translateY;\n\n      let pickerX = e.clientX + zoomFactor;\n      let pickerY = e.clientY;\n\n      // The color picker is 220 x 337 pixels\n      if (pickerX + 220 > window.innerWidth) {\n        pickerX -= 220;\n      }\n      if (pickerY + 337 > window.innerHeight - 70) {\n        pickerY -= 337;\n      }\n\n      this.setState({\n        dragStartX: startPositionX,\n        dragStartY: startPositionY,\n        colorPickerX: pickerX,\n        colorPickerY: pickerY,\n      });\n\n      // If the user moves after clicking, then they are dragging so we add listener\n      this.canvasRef.current!.addEventListener(\n        'mousemove',\n        this.updateTranslate\n      );\n    });\n\n    /**\n     * On mouse up, we check if the user was dragging. If they were, we set isDrag to false and\n     * remove the event listener for dragging.\n     *\n     * If they were not dragging, then we display the color picker so we can update the color of\n     * the pixel.\n     */\n    this.canvasRef.current!.addEventListener('mouseup', ev => {\n      this.canvasRef.current!.removeEventListener(\n        'mousemove',\n        this.updateTranslate\n      );\n\n      const { canUpdatePixel, updatePosition, isLoggedIn } = this.props;\n      if (!this.state.isDrag) {\n        if (canUpdatePixel && isLoggedIn) {\n          const { x: xNew, y: yNew } = this.getMousePos(\n            this.canvasRef.current,\n            ev\n          );\n          updatePosition(xNew, yNew);\n          this.showColorPicker();\n\n          const { position } = this.props;\n          const imageData = this.canvasRef\n            .current!.getContext('2d')!\n            .getImageData(position.x - 1, position.y - 1, 1, 1);\n\n          this.setState({\n            previousColor: {\n              r: imageData.data[0],\n              g: imageData.data[1],\n              b: imageData.data[2],\n            },\n          });\n        } else {\n          if (!isLoggedIn) {\n            notification.error({\n              message: 'Cannot update pixel',\n              description:\n                'Sorry, you must log in before you can update a pixel.',\n            });\n          } else {\n            notification.error({\n              message: 'Cannot update pixel',\n              description:\n                'Sorry, you cannot update a pixel at this time. Please wait until the timer is up in order to update another pixel.',\n            });\n          }\n        }\n      }\n\n      this.setState({\n        isDrag: false,\n      });\n    });\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (\n      this.props.initialImage &&\n      this.props.initialImage !== prevProps.initialImage\n    ) {\n      console.log('image drawn');\n      const context = this.canvasRef.current!.getContext('2d');\n      if (context) {\n        const image = new Image();\n        image.onload = function() {\n          context.drawImage(image, 0, 0);\n        };\n        image.src = this.props.initialImage;\n      }\n    }\n  }\n\n  updateTranslate(ev: MouseEvent) {\n    const { dragStartX, dragStartY } = this.state;\n    const x = ev.clientX - dragStartX;\n    const y = ev.clientY - dragStartY;\n    this.onCancel();\n    this.setState({\n      isDrag: true,\n      translateX: x,\n      translateY: y,\n    });\n  }\n\n  getMousePos(canvas, evt) {\n    const rect = canvas.getBoundingClientRect();\n    return {\n      x: evt.clientX - rect.left,\n      y: evt.clientY - rect.top,\n    };\n  }\n\n  onCancel() {\n    // In some states cancel is called without the color picker present (like zooming).\n    // In this case, we shouldn't update the canvas' color since it would have never changed.\n    this.hideColorPicker();\n\n    if (this.props.position && this.state.previousColor) {\n      const context = this.canvasRef.current!.getContext('2d');\n\n      const x = this.props.position.x;\n      const y = this.props.position.y;\n      const c = this.state.previousColor;\n\n      context!.fillStyle = 'rgb(' + c.r + ',' + c.g + ',' + c.b + ')';\n      context!.fillRect(x - 1, y - 1, 1, 1);\n    }\n    this.setState({ previousColor: null });\n  }\n\n  onComplete(color: Color) {\n    const { onUpdatePixel, position } = this.props;\n    this.hideColorPicker();\n    onUpdatePixel(color, position.x - 1, position.y - 1);\n  }\n\n  onColorChange(c: RGBColor) {\n    const context = this.canvasRef.current!.getContext('2d');\n    const x = this.props.position.x - 1;\n    const y = this.props.position.y - 1;\n    context!.fillStyle = `rgb(${c.r}, ${c.g}, ${c.b})`;\n    context!.fillRect(x, y, 1, 1);\n  }\n\n  showColorPicker() {\n    this.setState({\n      showColorPicker: true,\n    });\n  }\n\n  hideColorPicker() {\n    this.setState({\n      showColorPicker: false,\n    });\n  }\n\n  render() {\n    const { receivedError, zoomFactor, setZoomFactor, isLoading } = this.props;\n    const {\n      translateX,\n      translateY,\n      isDrag,\n      colorPickerX,\n      colorPickerY,\n    } = this.state;\n    return (\n      <div>\n        {/*   receivedError && <Redirect to='/error'/> */}\n        {isLoading && <Spin className='spinner-style' size='large' />}\n        <div\n          className={classNames({\n            'hide-canvas': isLoading,\n            'canvas-container': true,\n          })}\n        >\n          {this.state.showColorPicker && (\n            <ColorPicker\n              onColorChange={c => this.onColorChange(c)}\n              onCancel={() => this.onCancel()}\n              onComplete={this.onComplete}\n              className='color-picker'\n              style={{ top: `${colorPickerY}px`, left: `${colorPickerX}px` }}\n            />\n          )}\n\n          <div\n            className={classNames({\n              'pan-canvas': true,\n              'drag-canvas': isDrag,\n            })}\n            style={{ transform: `translate(${translateX}px, ${translateY}px)` }}\n          >\n            <div\n              className='zoom-canvas'\n              style={{ transform: `scale(${zoomFactor}, ${zoomFactor})` }}\n            >\n              <canvas ref={this.canvasRef} />\n            </div>\n          </div>\n          <div className='zoom-controls'>\n            <Icon\n              type='plus-circle'\n              onClick={() => {\n                setZoomFactor(zoomFactor + ZOOM_CHANGE_FACTOR);\n                this.onCancel();\n              }}\n              className='zoom-icon'\n            />\n            <Icon\n              type='minus-circle'\n              onClick={() => {\n                setZoomFactor(zoomFactor - ZOOM_CHANGE_FACTOR);\n                this.onCancel();\n              }}\n              className='zoom-icon'\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Canvas;\n","export const FETCH_IMAGE_ENDPOINT = '';\nexport const CANVAS_WIDTH = 1000;\nexport const CANVAS_HEIGHT = 1000;\nexport const DEFAULT_ZOOM = 41.0;\nexport const ZOOM_CHANGE_FACTOR = 10;\nexport const TIME_BETWEEN_UPDATES_MS = 3000;\n","import { State } from \"../types\";\n\nexport const getWebSocket = (state: State): WebSocket | undefined =>\n  state.websocket.socket || undefined;\nexport const getIsConnected = (state: State): boolean =>\n  state.websocket.isConnected;\nexport const receivedError = (state: State): boolean =>\n  state.websocket.receivedError;\nexport const getIsLoadingState = (state: State): boolean =>\n  state.websocket.isLoading;\n","import { State } from '../types';\nimport { Move } from './types';\n\nexport const getCanvasContext = (\n  state: State\n): CanvasRenderingContext2D | undefined =>\n  state.canvas.canvasContext || undefined;\n\nexport const getCurrentPosition = (\n  state: State\n): { x: number; y: number } | undefined =>\n  state.canvas.curPosition || undefined;\n\nexport const getZoomFactor = (state: State): number => state.canvas.zoomFactor;\n\nexport const getInitialImage = (state: State): string | undefined => \n  state.canvas.initialImage || undefined;\n\nexport const getTimeToChange = (state: State): number => \n  state.canvas.timeToNextChange;\n\nexport const canUpdatePixel = (state: State): boolean => \n  state.canvas.timeToNextChange === 0;\n\nexport const getLastMove = (state: State): Move | undefined => state.canvas.lastMove || undefined;\n","import { State } from '../types';\n\nexport const getIsLoggedIn = (state: State): boolean => state.login.isLoggedIn;\nexport const getUserName = (state: State): string | undefined => state.login.name || undefined;\nexport const getUserId = (state: State): string | undefined => state.login.userId || undefined;\nexport const getUserEmail = (state: State): string | undefined => state.login.email || undefined;\n","export const StartConnect = 'websocket/START_CONNECT';\nexport const ConnectSuccess = 'websocket/CONNECT_SUCCESS';\nexport const ConnectError = 'websocket/CONNECT_ERROR';\nexport const CloseConnection = 'websocket/CLOSE_CONNNECTION';\n","import { HOSTNAME } from '../constants';\nimport * as ActionTypes from './actionTypes';\nimport * as CanvasActionTypes from '../canvas/actionTypes';\nimport { getWebSocket } from './selectors';\nimport { MsgType } from '../message';\nimport { setImage } from '../canvas/actions';\nimport { getCanvasContext, getLastMove } from '../../src/canvas/selectors';\nconst startConnect = () => ({\n  type: ActionTypes.StartConnect\n});\nexport type StartConnect =  ReturnType<typeof startConnect>;\n\nexport const connectError = (error: string) => ({\n  type: ActionTypes.ConnectError,\n  payload: {\n    error\n  }\n});\nexport type ConnectError =  ReturnType<typeof connectError>;\n\nconst closeConnection = () => ({\n  type: ActionTypes.CloseConnection,\n});\nexport type CloseConnection =  ReturnType<typeof closeConnection>;\n\nconst connectSuccess = (socket: WebSocket) => ({\n  type: ActionTypes.ConnectSuccess,\n  payload: {\n    socket\n  }\n});\nexport type ConnectSuccess = ReturnType<typeof connectSuccess>;\n\nexport const openWebSocket = () => (dispatch, getState) => {\n  dispatch(startConnect());\n\n  const socket = new WebSocket(`ws://${HOSTNAME}/ws`);\n    // open message is 0\n    socket.onopen = () => {\n      socket.send(\n        JSON.stringify({\n          type: 0,\n          message: \"Hi From the Client! The websocket just opened\"\n        })\n      );\n      \n    dispatch(connectSuccess(socket));\n  };\n\n  // close message is 9\n  socket.onclose = event => {\n    dispatch(closeConnection());\n  };\n\n  socket.onerror = error => {\n    dispatch(connectError(error.type));\n  };\n\n  socket.onmessage = event => {\n    const { data } = event;\n    let json = JSON.parse(data);\n    console.log(\"RECEIVED: \" + json.type);\n    switch (json.type) {\n        case MsgType.IMAGE: {\n            // let msg = new ImageMsg(data.formatString); //now what?\n            let imageString = json.formatString\n            console.log(\"Received an IMAGE message from the server!\");\n            dispatch(setImage('data:image/png;base64,' + imageString));\n            break;\n        }\n        case MsgType.TESTING: {\n          console.log(\"Received a TESTING message from the server!\");\n          console.log(\"Message: \" + json.msg);\n          break;\n        }\n        case MsgType.CHANGECLIENTPIXEL: {\n          console.log(\"Received a CHANGECLIENTPIXEL message from the server!\");\n          let x = json.x\n          let y = json.y\n          // let color = { r: json.r, g: json.g, b: json.b }\n          dispatch(setColor(x, y, json.r, json.g, json.b))\n          break;\n        }\n        case MsgType.DRAWRESPONSE: {\n          let status = json.status\n          console.log(\"Received a DRAWRESPONSE message from the server!\");\n          console.log(\"The status was \" + status);\n          if (status === 503) {\n            // If update fails, we reset the pixel to its previous color\n            const prevMove = getLastMove(getState());\n            if (prevMove) {\n              const { x, y } = prevMove.position;\n              const { r, g, b } = prevMove.color;\n              dispatch(setColor(x, y, r, g, b));\n              dispatch({ type: CanvasActionTypes.UpdatePixelError });\n            }\n          } else {\n            dispatch({ type: CanvasActionTypes.UpdatePixelSuccess });\n          }\n          break;\n        }\n        case MsgType.VERIFICATIONFAIL: {\n          let status = json.status\n          console.log(\"Received a VERIFICATIONFAIL message from the server!\");\n          console.log(\"The status was \" + status);\n          // If user verification fails, direct to error page\n          dispatch({ type: ActionTypes.ConnectError });\n          break;\n        }\n        case MsgType.USERLOGINRESPONSE: {\n          let status = json.status\n          let cooldown = json.cooldown\n          console.log(\"Received a USERLOGIN message from the server!\");\n          console.log(\"The status was \" + status);\n          console.log(\"The remaining cooldown time for current user is: \" + cooldown);\n          break;\n        }\n        default: {\n            console.log(\"Received a message from the server of an unknown type, message: \" + data + \" type: \" + json.type) ;\n            break;\n        }\n    }\n    // TODO (Ryan): figure out the best way to handle this... probably need to write some middlewear\n\n  };\n}\n\nexport const makeUpdateMessage = (\n  id: string,\n  x: number,\n  y: number,\n  r: number,\n  g: number,\n  b: number\n) => {\n  return JSON.stringify({\n    type: 1,\n    userId: id,\n    x: x,\n    y: y,\n    r: r,\n    g: g,\n    b: b\n  });\n};\n\nconst setColor = (x: number, y: number, r: number, g: number, b: number) => (dispatch, getState) => {\n  console.log(\"inside set color in actions.ts\")\n  const state = getState();\n  const ctx = getCanvasContext(state);\n  if (ctx) {\n    ctx!.fillStyle = 'rgb('+ r + ',' + g + ',' + b + ')';\n    ctx!.fillRect(x , y , 1, 1);\n  }\n}\n\nexport const makeLoginMessage = (\n  email: string\n) => {\n  return JSON.stringify({\n    type: 2, \n    email: email\n  })\n}\n\nexport const sendUpdateMessage = (id, x, y, r, g, b) => (dispatch, getState) => {\n  const socket = getWebSocket(getState());\n  console.log(\"sending along websocket message\")\n  if (socket) {\n    socket.send(makeUpdateMessage(id, x, y, r, g, b));\n\n    // The follwing should be REMOVED when testing is done/ you want to only do single pixels\n    // let lower = 495;\n    // let upper = 505;\n    // for (let i = lower; i < upper; i++) {\n    //   for (let j = lower; j < upper; j++) {\n    //     console.log(\"sending..\")\n    //     socket.send(makeUpdateMessage(id, i, j, r, g, b));\n    //   }\n    // }\n  }\n}\n\nexport const sendLoginMessage = (email) => (dispatch, getState) => {\n  console.log(\"sending login message for email: \" + email)\n  const socket = getWebSocket(getState());\n  if (socket) {\n    socket.send(makeLoginMessage(email));\n  }\n}\n\nexport const closeWebSocket = () => (dispatch, getState) => {\n  const socket = getWebSocket(getState());\n  if (socket) {\n    socket.send(\n      JSON.stringify({\n        type: 9,\n        message: \"Client Closed!\"\n      })\n    );\n  }\n  dispatch(closeConnection());\n}\n","// import { FETCH_IMAGE_ENDPOINT } from './constants';\n// import { HOSTNAME } from '../constants';\nimport { Color } from './types';\nimport * as ActionTypes from './actionTypes';\nimport { getZoomFactor, getCanvasContext } from './selectors';\nimport { getWebSocket } from '../websocket/selectors';\nimport { getUserEmail } from '../login/selectors';\nimport { connectError, makeUpdateMessage } from '../websocket/actions';\n\nconst fetchImageDataStart = () => ({\n  type: ActionTypes.FetchImageStart\n});\nexport type FetchImageDataStart = ReturnType<typeof fetchImageDataStart>;\n\nexport const fetchImageData = () => dispatch => {\n  dispatch(fetchImageDataStart());\n};\n\nexport const setImage = (image: string) => ({\n  type: ActionTypes.FetchImageSuccess,\n  payload: {\n    image\n  }\n});\nexport type SetInitialImage = ReturnType<typeof setImage>;\n\nexport const setInitialImage = (image: string) => dispatch => {\n  console.log('setting image in state');\n  dispatch(setImage(image));\n}\n\nconst registerContext = (ctx: CanvasRenderingContext2D) => ({\n  type: ActionTypes.RegisterContext,\n  payload: {\n    context: ctx\n  }\n});\nexport type RegisterContext = ReturnType<typeof registerContext>;\n\nexport const registerCanvasContext = (\n  ctx: CanvasRenderingContext2D\n) => dispatch => {\n  dispatch(registerContext(ctx));\n};\n\nconst updatePosition = (x: number, y: number) => ({\n  type: ActionTypes.UpdatePosition,\n  payload: {\n    x,\n    y\n  }\n});\nexport type UpdatePosition = ReturnType<typeof updatePosition>;\n\nexport const updateCursorPosition = (x: number, y: number) => (\n  dispatch,\n  getState\n) => {\n  const state = getState();\n  const zoom = getZoomFactor(state);\n  dispatch(updatePosition(Math.ceil(x / zoom), Math.ceil(y / zoom)));\n};\n\nconst clearPosition = () => ({\n  type: ActionTypes.ClearPosition\n});\nexport type ClearPosition = ReturnType<typeof clearPosition>;\n\nexport const clearCursorPosition = () => dispatch => {\n  dispatch(clearPosition());\n};\n\nconst setZoom = (f: number) => ({\n  type: ActionTypes.SetZoom,\n  payload: {\n    zoom: f\n  }\n});\nexport type SetZoom = ReturnType<typeof setZoom>;\n\nexport const setZoomFactor = (newFactor: number) => (dispatch, getState) => {\n  if (newFactor < 0) {\n    return;\n  }\n\n  const state = getState();\n  const ctx = getCanvasContext(state);\n  if (ctx) {\n    ctx.scale(newFactor, newFactor);\n  }\n\n  dispatch(setZoom(newFactor));\n};\n\nconst updatePixelStart = (newColor: Color, x: number, y: number) => ({\n  type: ActionTypes.UpdatePixelStart,\n  payload: {\n    color: newColor,\n    position: { x, y }\n  }\n});\nexport type UpdatePixelStart = ReturnType<typeof updatePixelStart>;\n\nexport const updatePixel = (\n  newColor: Color,\n  x: number,\n  y: number\n) => (dispatch, getState) => {\n  dispatch(updatePixelStart(newColor, x, y));\n  const socket = getWebSocket(getState());\n  const email = getUserEmail(getState());\n  console.log(\"This is being called!\", newColor, newColor.r, newColor.g, newColor.b)\n  if (socket && email) {\n    socket.send(makeUpdateMessage(email, x, y, newColor.r, newColor.g, newColor.b));\n  } else {\n    dispatch(connectError('Could not connect'))\n  }\n};\n\nexport const setTimeRemaining = (time: number) => ({\n  type: ActionTypes.SetTimeRemaining,\n  payload: {\n    time,\n  }\n});\nexport type SetTimeRemaining = ReturnType<typeof setTimeRemaining>;\n\nexport const setTimeToNextMove = (time: number) => dispatch => {\n  // Don't let time remaining be negative\n  if (time < 0) {\n    dispatch(setTimeRemaining(0));\n  }\n  dispatch(setTimeRemaining(time));\n}\n","export const FetchImageStart = 'canvas/FETCH_IMAGE_START';\nexport const FetchImageSuccess = 'canvas/FETCH_IMAGE_SUCCESS';\nexport const FetchImageError = 'canvas/FETCH_IMAGE_ERROR';\nexport const UpdatePixelStart = 'canvas/UPDATE_PIXEL_START';\nexport const UpdatePixelSuccess = 'canvas/UPDATE_PIXEL_SUCCESS';\nexport const UpdatePixelError = 'canvas/UPDATE_PIXEL_ERROR';\nexport const RegisterContext = 'canvas/REGISTER_CONTEXT';\nexport const UpdatePosition = 'canvas/UPDATE_POSITION';\nexport const ClearPosition = 'canvas/CLEAR_POSITION';\nexport const SetZoom = 'canvas/SET_ZOOM';\nexport const SetTimeRemaining = 'canvas/SET_TIME_REMAINING';\n","import { connect } from 'react-redux';\nimport Canvas from '../components/Canvas';\nimport { receivedError, getIsLoadingState } from '../../websocket/selectors';\nimport {\n  registerCanvasContext,\n  updateCursorPosition,\n  clearCursorPosition,\n  setZoomFactor,\n  updatePixel,\n} from '../actions';\nimport {\n  getZoomFactor,\n  getCurrentPosition,\n  getInitialImage,\n  canUpdatePixel,\n} from '../selectors';\nimport { Color } from '../types';\nimport { getIsLoggedIn } from '../../login/selectors';\n\ninterface DispatchProps {\n  registerContext: (context: CanvasRenderingContext2D) => void;\n  updatePosition: (x: number, y: number) => void;\n  onMouseOut: () => void;\n  setZoomFactor: (newZoom: number) => void;\n  onUpdatePixel: (newColor: Color, x: number, y: number) => void;\n}\n\ninterface StateProps {\n  receivedError: boolean;\n  zoomFactor: number;\n  position: { x: number; y: number } | undefined;\n  isLoading: boolean;\n  initialImage?: string;\n  canUpdatePixel: boolean;\n  isLoggedIn: boolean; \n}\n\nconst mapDispatchToProps: DispatchProps = {\n  registerContext: registerCanvasContext,\n  updatePosition: updateCursorPosition,\n  onMouseOut: clearCursorPosition,\n  setZoomFactor: setZoomFactor,\n  onUpdatePixel: updatePixel\n};\n\nconst mapStateToProps = (state): StateProps => ({\n  receivedError: receivedError(state),\n  zoomFactor: getZoomFactor(state),\n  position: getCurrentPosition(state),\n  isLoading: getIsLoadingState(state),\n  initialImage: getInitialImage(state),\n  canUpdatePixel: canUpdatePixel(state),\n  isLoggedIn: getIsLoggedIn(state)\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Canvas);\n","import React, { FC } from 'react';\nimport CanvasContainer from './CanvasContainer';\n\n\n\nconst CanvasPageContainer: FC = () => (\n  <CanvasContainer />\n);\n\nexport default CanvasPageContainer;\n","import React, { FC } from 'react';\nimport './About.scss';\n\nconst About: FC = () => (\n  <div className='about-page'>\n    <h1>About</h1>\n\n    <p>\n      OwlPlace is a collaborative canvas editing application that allows users\n      to alter the contents of a shared canvas. Users will be able to change the\n      color of a single pixel within the canvas once per fixed time period\n      (likely once every couple minutes). When used by a large number of users,\n      groups of people may even collaborate and work together to create large\n      and intricate designs within the image for all to see. OwlPlace will\n      ensure that all users will see the same image at any given time, even\n      updating pixels live as other users change them.\n    </p>\n    <p>\n      Users will be able to access OwlPlace through a web application. When\n      visiting for the first time, users will be prompted to login with Google.\n      Once logged in, users will be able to view the canvas in its entirety,\n      zoom in on specific sections, see live updates to the canvas, and update\n      pixels. The goal of the front end of this application is to make the user\n      experience as simple as possible while still being engaging.\n    </p>\n    <p>\n      This application will be built on top of a distributed database. This\n      distributed database will be a custom solution implemented by our team\n      using the RAFT protocol to ensure consistency across servers. Each server\n      will run its own instance of the image control code and maintain its own\n      local database. RAFT will be used to maintain consistency of each serverâ€™s\n      local database and ensure that machines can recover the correct data if\n      they go offline and come back into the network. While the image and user\n      data systems will be somewhat separate from one another, they will use the\n      RAFT protocol API to ensure that local databases do not become out of sync\n      with one another.\n    </p>\n    <p>\n      For more information, visit the{' '}\n      <a href='https://docs.google.com/document/d/13_bi5Vf5WNiZuDCWOdyBopANCUBl-Cyt7jK-sCeUW2s/edit?usp=sharing'>\n        functional specification\n      </a>\n      .\n    </p>\n  </div>\n);\n\nexport default About;\n","import React, { FC } from 'react';\n\ninterface Props {\n  sendUpdateMessage: (id, x, y, r, g, b) => void;\n  sendLoginMessage: (id) => void;\n}\n\n\nconst Testing: FC<Props> = ({ sendUpdateMessage, sendLoginMessage }) => (\n  <div className='testing-page'>\n    <h2>TESTING AREA</h2>\n    <p>Click \"Pixel 1\" to send an update message to the server!</p>\n    <button onClick = {() => sendUpdateMessage(\"user1\", 10, 400, 255, 255, 255)} id=\"p1\"> Pixel 1 </button>\n    <button onClick = {() => sendLoginMessage(\"testemail@gmail.com\")} id=\"login\"> User Login </button>\n  </div>\n);\n\nexport default Testing;\n","import { connect } from 'react-redux';\nimport { sendUpdateMessage, sendLoginMessage } from '../../websocket/actions';\nimport Testing from '../components/Testing';\n\ninterface DispatchProps {\n  sendUpdateMessage: (id, x, y, r, g, b) => void;\n  sendLoginMessage: (email) => void;\n}\n\nconst mapDispatchToProps: DispatchProps = {\n  sendUpdateMessage: sendUpdateMessage,\n  sendLoginMessage: sendLoginMessage\n}\n\nexport default connect(\n  null,\n  mapDispatchToProps\n)(Testing);","import React, { FC, useState, useEffect } from 'react';\nimport { PageHeader, Button, Menu, Dropdown, Icon, notification } from 'antd';\nimport { Link, useLocation } from 'react-router-dom';\nimport './Header.scss';\n\ninterface Props {\n  isLoggedIn: boolean;\n  name?: string;\n  onLogin: () => void;\n  onLogout: () => void;\n  timeToNextChange: number;\n  setTimeRemaining: (time: number) => void;\n}\n\nconst Header: FC<Props> = ({\n  onLogin,\n  isLoggedIn,\n  name,\n  onLogout,\n  timeToNextChange,\n  setTimeRemaining\n}) => {\n  //@ts-ignore\n  window.onGoogleScriptLoad = () => {\n    console.log('The google script has really loaded, cool!');\n  };\n\n  const loginButton = isLoggedIn ? (\n    <div className='name-label' key='name'>Hi, {name}</div>\n  ) : (\n    <Button className='login-button' onClick={onLogin} key='login'>\n      Login\n    </Button>\n  );\n\n  let location = useLocation().pathname;\n  \n  const menu = (\n    <Menu>\n      <Menu.Item>\n        {/*Check the last 5 characters in a string.*/}\n        {location.substring(location.length - 5, location.length) !== 'about' ? (\n          <Link to='/about'>About</Link>\n        ) : (\n          <Link to='/'>Home</Link>\n        )}\n      </Menu.Item>\n\n      {isLoggedIn && <Menu.Item onClick={onLogout}>Sign Out</Menu.Item>}\n\n      {window.location.hostname === 'localhost' && <Menu.Item><Link to='/testing'>Testing</Link></Menu.Item>}\n    </Menu>\n  );\n\n  const dropdownMenu = (\n    <Dropdown key='more' overlay={menu}>\n      <Button\n        style={{\n          border: 'none',\n          padding: 0\n        }}\n      >\n        <Icon\n          type='ellipsis'\n          style={{\n            fontSize: 20,\n            verticalAlign: 'top'\n          }}\n        />\n      </Button>\n    </Dropdown>\n  );\n\n  const [time, setTime] = useState(timeToNextChange);\n\n  useEffect(() => {\n    setTime(timeToNextChange);\n  }, [timeToNextChange])\n\n  useEffect(() => {\n    // @ts-ignore\n    let interval: null | Timeout = null;\n    if (time <= 0) {\n      clearInterval(interval);\n      setTimeRemaining(0);\n      notification.success({\n        message: 'Place another pixel',\n        description: 'You can now update another pixel on the canvas.'\n      });\n      return;\n    }\n\n    interval = setInterval(() => {\n      setTime(time => time - 1000);\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [time, setTimeRemaining]);\n\n  const timerComponent = (\n    <div className='timer'>\n      {Math.floor(time / 60000)}:\n      {/* Get the number of seconds remaining, and force a trailing 0 if necessary */}\n      {('0' + Math.floor((time % 60000) / 1000)).slice(-2)}\n    </div>\n  );\n\n  return (\n    <PageHeader\n      title='OwlPlace'\n      subTitle='change the canvas one pixel at a time'\n      extra={[isLoggedIn ? timerComponent : null, loginButton, dropdownMenu]}\n    />\n  );\n};\n\nexport default Header;\n","export const LoginStart = 'login/LOGIN_START';\nexport const LoginSuccess = 'login/LOGIN_SUCCESS';\nexport const LoginError = 'login/LOGIN_ERROR';\nexport const SignOut = 'login/SIGN_OUT';\n","import * as ActionTypes from './actionTypes';\nimport { getWebSocket } from '../websocket/selectors';\nimport { makeLoginMessage, connectError } from '../websocket/actions';\n\nconst loginStart = () => ({\n  type: ActionTypes.LoginStart\n});\nexport type LoginStart = ReturnType<typeof loginStart>;\n\nconst loginSuccess = (name: string, id: string, email: string) => ({\n  type: ActionTypes.LoginSuccess,\n  payload: {\n    name,\n    id,\n    email,\n  }\n});\nexport type LoginSuccess = ReturnType<typeof loginSuccess>;\n\nconst loginError = () => ({\n  type: ActionTypes.LoginError\n});\nexport type LoginError = ReturnType<typeof loginError>;\n\nexport const login = () => async (dispatch, getState) => {\n  dispatch(loginStart());\n\n  /**\n   * The Sign-In client object.\n   */\n   // eslint-disable-next-line\n   let auth2: any;\n\n  const googleAPILoaded: Promise<void> = new Promise(resolve => {\n    gapi.load('auth2', () => {\n      /**\n       * Retrieve the singleton for the GoogleAuth library and set up the\n       * client.\n       */\n      auth2 = gapi.auth2.init({\n          client_id: '634069824484-ch6gklc2fevg9852aohe6sv2ctq7icbk.apps.googleusercontent.com'\n      });\n      resolve();\n    });\n  });\n\n  await googleAPILoaded;\n\n  await gapi.auth2.getAuthInstance().signIn();\n  const googleUser = gapi.auth2.getAuthInstance().currentUser.get();\n  const profile = googleUser.getBasicProfile();\n\n  dispatch(loginSuccess(profile.getName(), profile.getId(), profile.getEmail()));\n\n  const socket = getWebSocket(getState());\n\n  if (socket){\n    socket.send(makeLoginMessage(profile.getEmail()));\n  } else {\n    dispatch(connectError('Unable to connect'));\n  }\n}\n\nexport const checkLogin = () => async dispatch => {\n  dispatch(loginStart());\n\n  /**\n  * The Sign-In client object.\n  */\n let auth2: any;\n\n  return new Promise(resolve => {\n    const timeout = setTimeout(() => Promise.resolve(), 3000);\n    const loadApi = () => new Promise(resolve => {\n      while (!window.gapi) {} \n      resolve()\n    });\n\n    Promise.race([timeout, loadApi]);\n    if (!window.gapi) {\n      return;\n    }\n\n    gapi.load('auth2', () => {\n     /**\n      * Retrieve the singleton for the GoogleAuth library and set up the\n      * client.\n      */\n     gapi.auth2.init({\n         client_id: '634069824484-ch6gklc2fevg9852aohe6sv2ctq7icbk.apps.googleusercontent.com'\n     }).then( function() {\n         // Sign in the user if they are currently signed in.\n         auth2 = gapi.auth2.getAuthInstance(); \n         if (auth2.isSignedIn.get()) {\n           const googleUser = gapi.auth2.getAuthInstance().currentUser.get();\n           const profile = googleUser.getBasicProfile();\n           dispatch(loginSuccess(profile.getName(), profile.getName(), profile.getEmail())); \n         }\n       }\n     );\n\n      resolve();\n   });\n });\n}\n\nconst signOutAction = () => ({\n  type: ActionTypes.SignOut\n});\nexport type SignOut = ReturnType<typeof signOutAction>;\n\nexport const signOut = () => async dispatch => {\n  const auth2 = gapi.auth2.getAuthInstance();\n  await auth2.signOut();\n  dispatch(signOutAction());\n}\n","import { connect } from 'react-redux';\nimport Header from '../components/Header';\nimport { login, signOut } from '../../login/actions';\nimport { getIsLoggedIn, getUserName } from '../../login/selectors';\nimport { getTimeToChange } from '../../canvas/selectors';\nimport { setTimeToNextMove } from '../../canvas/actions';\n\ninterface DispatchProps {\n  onLogin: () => void;\n  onLogout: () => void;\n  setTimeRemaining: (time: number) => void;\n}\n\ninterface StateProps {\n  isLoggedIn: boolean;\n  name?: string;\n  timeToNextChange: number;\n}\n\nconst mapDispatchToProps: DispatchProps = {\n  onLogin: login,\n  onLogout: signOut,\n  setTimeRemaining: setTimeToNextMove,\n}\n\nconst mapStateToProps = (state): StateProps => ({\n  isLoggedIn: getIsLoggedIn(state),\n  name: getUserName(state),\n  timeToNextChange: getTimeToChange(state),\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Header);\n","import React from \"react\";\nimport \"./Footer.scss\";\n\nconst Footer: React.FC = () => {\n  return (\n    <div>\n      <footer>Made with &hearts; by COMP 413 @ Rice</footer>\n    </div>\n  );\n};\n\nexport default Footer;\n","import React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport './Error.scss';\n\ninterface Props {}\n\ninterface State {}\n\nclass Error extends Component<Props, State> {\n  shouldRedirect = false;\n\n  componentDidMount() {\n    window.addEventListener('beforeunload', () => {\n      this.shouldRedirect = true;\n      this.forceUpdate();\n    });\n  }\n\n  render() {\n    return this.shouldRedirect ? (\n      <Redirect to='/' />\n    ) : (\n      <div className='error-page'>\n        <div className='error-title'>Whoops, something went wrong.</div>\n        <p>Hang tight, we're working hard to fix the issue!</p>\n      </div>\n    );\n  }\n}\n\nexport default Error;\n","import React, { FC } from 'react';\nimport { HashRouter as Router, Route } from 'react-router-dom';\nimport ScrollToTop from './components/ScrollToTop';\nimport CanvasPageContainer from './canvas/containers/CanvasPageContainer';\nimport AboutPage from './about/components/About';\nimport TestingPage from './testing/containers/TestingContainer';\nimport Header from './header/containers/HeaderContainer';\nimport Footer from './footer/components/Footer';\nimport ErrorPage from './error/components/Error';\n\nconst RoutingContainer: FC = () => (\n  <Router basename='/OwlPlace'>\n    <ScrollToTop>\n      <Header />\n      <Route exact path='/' component={CanvasPageContainer} />\n      <Route path='/about' component={AboutPage} />\n      <Route path='/error' component={ErrorPage} />\n      <Route path='/testing' component={TestingPage} />\n      <Footer />\n    </ScrollToTop>\n  </Router>\n);\n\nexport default RoutingContainer;\n","import React from \"react\";\nimport \"./App.scss\";\nimport RoutingContainer from './RoutingContainer';\nimport { connect } from 'react-redux';\nimport { checkLogin } from './login/actions';\nimport { openWebSocket } from './websocket/actions';\n\n// // updateMessage is type 1\n// const updateMessage = (\n//   id: string,\n//   x: number,\n//   y: number,\n//   r: number,\n//   g: number,\n//   b: number\n// ) => {\n//   return JSON.stringify({\n//     type: 1,\n//     userId: id,\n//     x: x,\n//     y: y,\n//     r: r,\n//     g: g,\n//     b: b\n//   });\n// };\n// const onClickP1 = (\n//   id: string,\n//   x: number,\n//   y: number,\n//   r: number,\n//   g: number,\n//   b: number\n// ) => {\n//   console.log(\"Sending update of Pixel 1\");\n//   socket.send(updateMessage(id, x, y, r, g, b));\n\n//   return true;\n// }\n\ninterface Props {\n  checkLogin: () => void;\n  openConnection: () => void;\n}\n\nclass App extends React.Component<Props> {\n\n  componentDidMount() {\n    this.props.checkLogin();\n    this.props.openConnection();\n  }\n  \n  render() {\n    return (\n      // <div>\n      //   <div className=\"top-nav-bar\">\n      //     <button className=\"login-btn\" onClick={onSignIn}>\n      //       <p className=\"login-text\">login</p>\n      //     </button>\n      //   </div>\n      //   <div className=\"main-wrapper\">\n      //     <h1>owlplaces</h1>\n      //     <h2>change the canvas one pixel at a time</h2>\n      //     <p>Click \"Pixel 1\" to send an update message to the server!\n      //       </p>\n      //       <button onClick = {() => onClickP1(\"user1\", 10, 400, 255, 255, 255)} id=\"p1\"> Pixel 1 </button>\n      //       {/* <button onClick= {onClickClose} id=\"close\">Close</button> */}\n      //   </div>\n      // </div>\n      <RoutingContainer />\n    );\n  }\n};\n\nconst mapDispatchToProps: Props = {\n  checkLogin: checkLogin,\n  openConnection: openWebSocket\n}\n\nexport default connect(\n  null,\n  mapDispatchToProps,\n)(App);","// export const HOSTNAME = '127.0.0.1:3001';\nexport const HOSTNAME = '35.184.250.155:3001';\n// The above line should be uncommented and replaced with the \n// docker-machine ip on windows computers\n","// TODO (ryan): add stricter typing to handlers\nexport function createReducer<T>(\n  initialState: T,\n  handlers\n) {\n  return function(state: T = initialState, action): T {\n    const handler = handlers[action && action.type];\n    if (!handler) {\n      return state;\n    }\n    return handler(state, action);\n  };\n}\n","import { Move } from './types';\nimport * as ActionTypes from './actionTypes';\nimport { combineReducers } from 'redux';\nimport { createReducer } from '../createReducer';\nimport { RegisterContext, UpdatePosition, SetZoom, SetInitialImage, SetTimeRemaining, UpdatePixelStart} from './actions';\nimport * as WebSocketActionTypes from '../websocket/actionTypes';\nimport { DEFAULT_ZOOM, TIME_BETWEEN_UPDATES_MS } from './constants';\n\nexport interface State {\n  canvasContext: CanvasRenderingContext2D | null;\n  initialImage: string | null;\n  curPosition: { x: number; y: number } | null;\n  zoomFactor: number;\n  timeToNextChange: number;\n  lastMove: Move | null;\n}\n\nconst canvasContext = createReducer<State['canvasContext']>(null, {\n  [WebSocketActionTypes.ConnectError]: () => null,\n  [ActionTypes.RegisterContext]: (state, action: RegisterContext) =>\n    action.payload.context\n});\n\nconst curPosition = createReducer<State['curPosition']>(null, {\n  [ActionTypes.ClearPosition]: () => null,\n  [ActionTypes.UpdatePosition]: (state, action: UpdatePosition) =>\n    action.payload\n});\n\nconst zoomFactor = createReducer<State['zoomFactor']>(DEFAULT_ZOOM, {\n  [ActionTypes.SetZoom]: (state, action: SetZoom) => action.payload.zoom\n});\n\nconst initialImage = createReducer<State['initialImage']>(null, {\n  [ActionTypes.FetchImageError]: () => null,\n  [ActionTypes.FetchImageStart]: () => null,\n  [ActionTypes.FetchImageSuccess]: (state, action: SetInitialImage) => action.payload.image,\n})\nconst timeToNextChange = createReducer<State['timeToNextChange']>(0, {\n  [ActionTypes.SetTimeRemaining]: (state, action: SetTimeRemaining) => action.payload.time,\n  [ActionTypes.UpdatePixelStart]: () => TIME_BETWEEN_UPDATES_MS,\n  [ActionTypes.UpdatePixelError]: () => 0,\n});\n\nconst lastMove = createReducer<State['lastMove']>(null, {\n  [ActionTypes.UpdatePixelStart]: (state, action: UpdatePixelStart) => ({ color: action.payload.color, position: action.payload.position }),\n});\n\nexport default combineReducers({\n  canvasContext,\n  curPosition,\n  zoomFactor,\n  initialImage,\n  timeToNextChange,\n  lastMove\n});\n","import { createReducer } from '../createReducer';\nimport * as ActionTypes from './actionTypes';\nimport { combineReducers } from 'redux';\nimport { LoginSuccess } from './actions';\n\n\nexport interface State {\n  isLoggedIn: boolean;\n  name: string | null;\n  email: string | null;\n  userId: string | null;\n}\n\nconst isLoggedIn = createReducer<State['isLoggedIn']>(false, {\n  [ActionTypes.LoginStart]: () =>  false,\n  [ActionTypes.LoginError]: () =>  false,\n  [ActionTypes.SignOut]: () => false,\n  [ActionTypes.LoginSuccess]: () => true,\n});\n\nconst name = createReducer<State['name']>(null, {\n  [ActionTypes.LoginStart]: () =>  null,\n  [ActionTypes.LoginError]: () =>  null,\n  [ActionTypes.SignOut]: () => null,\n  [ActionTypes.LoginSuccess]: (state, action: LoginSuccess) => action.payload.name,\n});\n\nconst email = createReducer<State['name']>(null, {\n  [ActionTypes.LoginStart]: () =>  null,\n  [ActionTypes.LoginError]: () =>  null,\n  [ActionTypes.SignOut]: () => null,\n  [ActionTypes.LoginSuccess]: (state, action: LoginSuccess) => action.payload.email,\n});\n\nconst id = createReducer<State['userId']>(null, {\n  [ActionTypes.LoginStart]: () =>  null,\n  [ActionTypes.LoginError]: () =>  null,\n  [ActionTypes.SignOut]: () => null,\n  [ActionTypes.LoginSuccess]: (state, action: LoginSuccess) => action.payload.id,\n});\n\n\n\nexport default combineReducers({\n  isLoggedIn,\n  name,\n  email,\n  id,\n});\n","import { createReducer } from '../createReducer';\nimport * as ActionTypes from './actionTypes';\nimport { ConnectSuccess } from './actions';\nimport { combineReducers } from 'redux';\n\nexport interface State {\n  socket: WebSocket | null;\n  isConnected: boolean;\n  receivedError: boolean;\n  isLoading: boolean;\n}\n\nconst socket = createReducer<State['socket']>(null, {\n  [ActionTypes.StartConnect]: () => null,\n  [ActionTypes.ConnectError]: () => null,\n  [ActionTypes.CloseConnection]: () => null,\n  [ActionTypes.ConnectSuccess]: (state, action: ConnectSuccess) =>\n    action.payload.socket\n});\n\nconst isConnected = createReducer<State['isConnected']>(false, {\n  [ActionTypes.StartConnect]: () => false,\n  [ActionTypes.ConnectError]: () => false,\n  [ActionTypes.CloseConnection]: () => false,\n  [ActionTypes.ConnectSuccess]: () => true\n});\n\nconst receivedError = createReducer<State['receivedError']>(false, {\n  [ActionTypes.StartConnect]: () => false,\n  [ActionTypes.ConnectError]: () => true,\n  [ActionTypes.CloseConnection]: () => false,\n  [ActionTypes.ConnectSuccess]: () => false\n});\n\nconst isLoading = createReducer<State['isLoading']>(false, {\n  [ActionTypes.StartConnect]: () => true,\n  [ActionTypes.ConnectError]: () => false,\n  [ActionTypes.CloseConnection]: () => false,\n  [ActionTypes.ConnectSuccess]: () => false\n});\n\nexport default combineReducers({\n  socket,\n  isConnected,\n  receivedError,\n  isLoading\n});\n","import React from 'react';\nimport { render } from 'react-dom'\nimport './index.scss';\nimport App from './App';\nimport { combineReducers, createStore, applyMiddleware, compose } from 'redux';\nimport canvasReducers from './canvas/reducers';\nimport loginReducers from './login/reducers';\nimport webSocketReducers from './websocket/reducers';\nimport { Provider } from 'react-redux';\nimport thunk from 'redux-thunk';\n\nconst rootReducer = combineReducers({\n  canvas: canvasReducers,\n  login: loginReducers,\n  websocket: webSocketReducers,\n});\n\n// @ts-ignore - redux devtools doesn't have type definitions\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\nexport const store = createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)));\n\nrender(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}