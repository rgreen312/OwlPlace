(window.webpackJsonpclient=window.webpackJsonpclient||[]).push([[0],{204:function(e,t,n){e.exports=n(439)},209:function(e,t,n){},210:function(e,t,n){},379:function(e,t,n){},423:function(e,t,n){},424:function(e,t,n){},425:function(e,t,n){},438:function(e,t,n){},439:function(e,t,n){"use strict";n.r(t);var a,o,r=n(0),c=n.n(r),i=n(6),u=(n(209),n(91)),s=n(92),l=n(94),f=n(93),p=n(95),m=(n(210),n(58)),d=n(40),g=Object(d.f)(function(e){var t=e.children,n=e.location.pathname;return Object(r.useEffect)(function(){window.scrollTo(0,0)},[n]),t||null}),h=n(29),b=n(59),v=n(202),O=n(190),E=n(97),y=(n(379),function(e){var t=e.onComplete,n=e.onCancel,a=Object(r.useState)({r:0,g:0,b:0}),o=Object(v.a)(a,2),i=o[0],u=o[1];return c.a.createElement("div",null,c.a.createElement(O.SketchPicker,{color:i,onChange:function(e){return u({r:e.rgb.r,b:e.rgb.b,g:e.rgb.g})}}),c.a.createElement("div",{className:"button-bar"},c.a.createElement(E.a,{onClick:function(){return t(i)},className:"okay-button"},"Okay"),c.a.createElement(E.a,{onClick:n,className:"cancel-button"},"Cancel")))}),w=(n(423),n(13)),j=n(3),C=n.n(j),k=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(f.a)(t).call(this,e))).canvasRef=void 0,n.canvasRef=Object(r.createRef)(),n.state={showColorPicker:!1,isDrag:!1,translateX:0,translateY:0,dragStartX:0,dragStartY:0},n.onCancel=n.onCancel.bind(Object(b.a)(n)),n.onComplete=n.onComplete.bind(Object(b.a)(n)),n.updateTranslate=n.updateTranslate.bind(Object(b.a)(n)),n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.canvasRef.current.width=1e3,this.canvasRef.current.height=1e3;var t=this.canvasRef.current.getContext("2d");t&&this.props.registerContext(t),t.imageSmoothingEnabled=!1,t.fillStyle="#000000",t.fillRect(0,0,1e3,500),t.fillStyle="#ff0000",t.fillRect(0,500,1e3,500),this.canvasRef.current.addEventListener("mousemove",function(t){if(!e.state.showColorPicker){var n=e.getMousePos(e.canvasRef.current,t),a=n.x,o=n.y;e.props.updatePosition(a,o)}}),this.canvasRef.current.addEventListener("mouseout",function(){e.state.showColorPicker||e.props.onMouseOut()}),this.canvasRef.current.addEventListener("mousedown",function(t){var n=e.state,a=n.translateX,o=n.translateY,r=t.clientX-a,c=t.clientY-o;e.setState({dragStartX:r,dragStartY:c}),e.canvasRef.current.addEventListener("mousemove",e.updateTranslate)}),this.canvasRef.current.addEventListener("mouseup",function(t){if(e.canvasRef.current.removeEventListener("mousemove",e.updateTranslate),!e.state.isDrag){var n=e.getMousePos(e.canvasRef.current,t),a=n.x,o=n.y;e.props.updatePosition(a,o),e.showColorPicker()}e.setState({isDrag:!1})})}},{key:"updateTranslate",value:function(e){var t=this.state,n=t.dragStartX,a=t.dragStartY,o=e.clientX-n,r=e.clientY-a;this.setState({isDrag:!0,translateX:o,translateY:r})}},{key:"getMousePos",value:function(e,t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}},{key:"onCancel",value:function(){this.hideColorPicker()}},{key:"onComplete",value:function(e){this.hideColorPicker();var t=this.canvasRef.current.getContext("2d"),n=this.props.position.x-1,a=this.props.position.y-1;t.fillStyle="rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")"),t.fillRect(n,a,1,1),this.props.onUpdatePixel({r:e.r,g:e.g,b:e.b},n,a)}},{key:"showColorPicker",value:function(){this.setState({showColorPicker:!0})}},{key:"hideColorPicker",value:function(){this.setState({showColorPicker:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=(t.receivedError,t.zoomFactor),a=t.setZoomFactor,o=this.state,r=o.translateX,i=o.translateY,u=o.isDrag;return c.a.createElement("div",{className:"canvas-container"},this.state.showColorPicker&&c.a.createElement("div",{className:"color-picker"},c.a.createElement(y,{onCancel:this.onCancel,onComplete:function(t){return e.onComplete(t)}})),c.a.createElement("div",{className:C()({"pan-canvas":!0,"drag-canvas":u}),style:{transform:"translate(".concat(r,"px, ").concat(i,"px)")}},c.a.createElement("div",{className:"zoom-canvas",style:{transform:"scale(".concat(n,", ").concat(n,")")}},c.a.createElement("canvas",{ref:this.canvasRef}))),c.a.createElement("div",{className:"zoom-controls"},c.a.createElement(w.a,{type:"plus-circle",onClick:function(){return a(n+10)},className:"zoom-icon"}),c.a.createElement(w.a,{type:"minus-circle",onClick:function(){return a(n-10)},className:"zoom-icon"})))}}]),t}(r.Component),S=function(e){return e.websocket.socket||void 0},N=function(e){return e.websocket.receivedError},P=function(e){return e.canvas.curPosition||void 0},T=function(e){return e.canvas.zoomFactor},R={registerContext:function(e){return function(t){t(function(e){return{type:"canvas/REGISTER_CONTEXT",payload:{context:e}}}(e))}},updatePosition:function(e,t){return function(n,a){var o=a(),r=T(o);n(function(e,t){return{type:"canvas/UPDATE_POSITION",payload:{x:e,y:t}}}(Math.ceil(e/r),Math.ceil(t/r)))}},onMouseOut:function(){return function(e){e({type:"canvas/CLEAR_POSITION"})}},setZoomFactor:function(e){return function(t,n){if(!(e<0)){var a=function(e){return e.canvas.canvasContext||void 0}(n());a&&a.scale(e,e),t({type:"canvas/SET_ZOOM",payload:{zoom:e}})}}},onUpdatePixel:function(e,t,n){return function(e){}}},x=Object(h.b)(function(e){return{receivedError:N(e),zoomFactor:T(e),position:P(e)}},R)(k),I=function(){return c.a.createElement(x,null)},_="websocket/START_CONNECT",L="websocket/CONNECT_SUCCESS",A="websocket/CONNECT_ERROR",M="websocket/CLOSE_CONNNECTION",U=function(){return{type:M}},X=(n(424),function(e){e.sendUpdateMessage;return c.a.createElement("div",{className:"about-page"},c.a.createElement("h1",null,"OwlPlace"),c.a.createElement("p",null,"OwlPlace is a collaborative canvas editing application that allows users to alter the contents of a shared canvas. Users will be able to change the color of a single pixel within the canvas once per fixed time period (likely once every couple minutes). When used by a large number of users, groups of people may even collaborate and work together to create large and intricate designs within the image for all to see. OwlPlace will ensure that all users will see the same image at any given time, even updating pixels live as other users change them."),c.a.createElement("p",null,"Users will be able to access OwlPlace through a web application. When visiting for the first time, users will be prompted to login with Google. Once logged in, users will be able to view the canvas in its entirety, zoom in on specific sections, see live updates to the canvas, and update pixels. The goal of the front end of this application is to make the user experience as simple as possible while still being engaging."),c.a.createElement("p",null,"This application will be built on top of a distributed database. This distributed database will be a custom solution implemented by our team using the RAFT protocol to ensure consistency across servers. Each server will run its own instance of the image control code and maintain its own local database. RAFT will be used to maintain consistency of each server\u2019s local database and ensure that machines can recover the correct data if they go offline and come back into the network. While the image and user data systems will be somewhat separate from one another, they will use the RAFT protocol API to ensure that local databases do not become out of sync with one another."),c.a.createElement("p",null,"For more information, visit the"," ",c.a.createElement("a",{href:"https://docs.google.com/document/d/13_bi5Vf5WNiZuDCWOdyBopANCUBl-Cyt7jK-sCeUW2s/edit?usp=sharing"},"functional specification"),"."))}),z={sendUpdateMessage:function(e,t,n,a,o,r){return function(c,i){var u=S(i());u&&u.send(function(e,t,n,a,o,r){return JSON.stringify({type:1,userId:e,x:t,y:n,r:a,g:o,b:r})}(e,t,n,a,o,r))}}},D=Object(h.b)(null,z)(X),F=n(137),Y=n(441),G=n(440),W=(n(425),function(e){var t=e.onLogin,n=e.isLoggedIn,a=e.name,o=e.onLogout;window.onGoogleScriptLoad=function(){console.log("The google script has really loaded, cool!")};var r=n?c.a.createElement("div",{className:"name-label"},"Hi, ",a):c.a.createElement(E.a,{className:"login-button",onClick:t},"Login"),i=Object(d.e)().pathname,u=c.a.createElement(F.a,null,c.a.createElement(F.a.Item,null,"about"!=i.substring(i.length-5,i.length)?c.a.createElement(m.b,{to:"/about"},"About"):c.a.createElement(m.b,{to:"/"},"Home")),n&&c.a.createElement(F.a.Item,{onClick:o},"Sign Out")),s=c.a.createElement(Y.a,{key:"more",overlay:u},c.a.createElement(E.a,{style:{border:"none",padding:0}},c.a.createElement(w.a,{type:"ellipsis",style:{fontSize:20,verticalAlign:"top"}})));return c.a.createElement(G.a,{title:"OwlPlace",subTitle:"change the canvas one pixel at a time",extra:[r,s]})}),B=n(50),J=n.n(B),Z=n(96),H="login/LOGIN_START",q="login/LOGIN_SUCCESS",V="login/LOGIN_ERROR",K="login/SIGN_OUT",Q=function(){return{type:H}},$=function(e,t,n){return{type:q,payload:{name:e,id:t,email:n}}},ee=function(e){return e.login.isLoggedIn},te=function(e){return e.login.name||void 0},ne={onLogin:function(){return function(){var e=Object(Z.a)(J.a.mark(function e(t){var n,a,o;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t(Q()),n=new Promise(function(e){gapi.load("auth2",function(){gapi.auth2.init({client_id:"634069824484-ch6gklc2fevg9852aohe6sv2ctq7icbk.apps.googleusercontent.com"}),e()})}),e.next=4,n;case 4:return e.next=6,gapi.auth2.getAuthInstance().signIn();case 6:a=gapi.auth2.getAuthInstance().currentUser.get(),o=a.getBasicProfile(),t($(o.getName(),o.getId(),o.getEmail()));case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},onLogout:function(){return function(){var e=Object(Z.a)(J.a.mark(function e(t){var n;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=gapi.auth2.getAuthInstance(),e.next=3,n.signOut();case 3:t({type:K});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}},ae=Object(h.b)(function(e){return{isLoggedIn:ee(e),name:te(e)}},ne)(W),oe=(n(438),function(){return c.a.createElement("div",null,c.a.createElement("footer",null,"Made with \u2665 by COMP 413 @ Rice"))}),re=function(){return c.a.createElement("div",{className:"error-page"},"There was an error.")},ce=function(){return c.a.createElement(m.a,{basename:"/OwlPlace"},c.a.createElement(g,null,c.a.createElement(ae,null),c.a.createElement(d.a,{exact:!0,path:"/",component:I}),c.a.createElement(d.a,{path:"/about",component:D}),c.a.createElement(d.a,{path:"/error",component:re}),c.a.createElement(oe,null)))},ie=function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.checkLogin(),this.props.openConnection()}},{key:"render",value:function(){return c.a.createElement(ce,null)}}]),t}(c.a.Component),ue={checkLogin:function(){return function(){var e=Object(Z.a)(J.a.mark(function e(t){return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t(Q()),e.abrupt("return",new Promise(function(e){var n=setTimeout(function(){return Promise.resolve()},3e3);Promise.race([n,function(){return new Promise(function(e){for(;!window.gapi;);e()})}]),window.gapi&&gapi.load("auth2",function(){gapi.auth2.init({client_id:"634069824484-ch6gklc2fevg9852aohe6sv2ctq7icbk.apps.googleusercontent.com"}).then(function(){if(gapi.auth2.getAuthInstance().isSignedIn.get()){var e=gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile();t($(e.getName(),e.getName(),e.getEmail()))}}),e()})}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},openConnection:function(){return function(e){e({type:_});var t=new WebSocket("ws://".concat("127.0.0.1:3001","/ws"));t.onopen=function(){t.send(JSON.stringify({type:0,message:"Hi From the Client! The websocket just opened"})),t.send(JSON.stringify({type:1,userId:"AAAAAA",x:6,y:9,r:4,g:2,b:0})),e(function(e){return{type:L,payload:{socket:e}}}(t))},t.onclose=function(t){e(U())},t.onerror=function(t){e(function(e){return{type:A,payload:{error:e}}}(t.type))},t.onmessage=function(e){var t=e.data;console.log("Recieved a message from the server, message: "+t)}}}},se=Object(h.b)(null,ue)(ie),le=n(19),fe=n(8);function pe(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,a=arguments.length>1?arguments[1]:void 0,o=t[a&&a.type];return o?o(n,a):n}}var me,de,ge,he,be,ve,Oe,Ee=pe(null,(a={},Object(fe.a)(a,A,function(){return null}),Object(fe.a)(a,"canvas/REGISTER_CONTEXT",function(e,t){return t.payload.context}),a)),ye=pe(null,(o={},Object(fe.a)(o,"canvas/CLEAR_POSITION",function(){return null}),Object(fe.a)(o,"canvas/UPDATE_POSITION",function(e,t){return t.payload}),o)),we=pe(41,Object(fe.a)({},"canvas/SET_ZOOM",function(e,t){return t.payload.zoom})),je=Object(le.c)({canvasContext:Ee,curPosition:ye,zoomFactor:we}),Ce=pe(!1,(me={},Object(fe.a)(me,H,function(){return!1}),Object(fe.a)(me,V,function(){return!1}),Object(fe.a)(me,K,function(){return!1}),Object(fe.a)(me,q,function(){return!0}),me)),ke=pe(null,(de={},Object(fe.a)(de,H,function(){return null}),Object(fe.a)(de,V,function(){return null}),Object(fe.a)(de,K,function(){return null}),Object(fe.a)(de,q,function(e,t){return t.payload.name}),de)),Se=pe(null,(ge={},Object(fe.a)(ge,H,function(){return null}),Object(fe.a)(ge,V,function(){return null}),Object(fe.a)(ge,K,function(){return null}),Object(fe.a)(ge,q,function(e,t){return t.payload.email}),ge)),Ne=pe(null,(he={},Object(fe.a)(he,H,function(){return null}),Object(fe.a)(he,V,function(){return null}),Object(fe.a)(he,K,function(){return null}),Object(fe.a)(he,q,function(e,t){return t.payload.id}),he)),Pe=Object(le.c)({isLoggedIn:Ce,name:ke,email:Se,id:Ne}),Te=pe(null,(be={},Object(fe.a)(be,_,function(){return null}),Object(fe.a)(be,A,function(){return null}),Object(fe.a)(be,M,function(){return null}),Object(fe.a)(be,L,function(e,t){return t.payload.socket}),be)),Re=pe(!1,(ve={},Object(fe.a)(ve,_,function(){return!1}),Object(fe.a)(ve,A,function(){return!1}),Object(fe.a)(ve,M,function(){return!1}),Object(fe.a)(ve,L,function(){return!0}),ve)),xe=pe(!1,(Oe={},Object(fe.a)(Oe,_,function(){return!1}),Object(fe.a)(Oe,A,function(){return!0}),Object(fe.a)(Oe,M,function(){return!1}),Object(fe.a)(Oe,L,function(){return!1}),Oe)),Ie=Object(le.c)({socket:Te,isConnected:Re,receivedError:xe}),_e=n(201);n.d(t,"store",function(){return Me});var Le=Object(le.c)({canvas:je,login:Pe,websocket:Ie}),Ae=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||le.d,Me=Object(le.e)(Le,Ae(Object(le.a)(_e.a)));Object(i.render)(c.a.createElement(h.a,{store:Me},c.a.createElement(se,null)),document.getElementById("root"))}},[[204,1,2]]]);
//# sourceMappingURL=main.48bf9966.chunk.js.map